This is a compilation of notes to be used as a walkthrough / cheat-sheet
for an arch linux install. Use alongside the official install guide, not
as a substitute, in case anything about the process changes.

/* 1. Pre-installation */

1.1 Acqure an installation image
1.2 Verify signature
1.3 Prepare an installation medium
1.4 Boot the live environment
1.5 Set the console keyboard layout

  Everything above can be skipped. It's just downloading the iso and
  creating a bootable USB. The keyboard doesn't need to be set as the
  default US is correct. Refer to the above steps if you don't have
  a bootable USB and need to create one but otherwise skip to the next
  step.
  
1.6 Verify the boot mode
  Just run the following command and make sure it prints a bunch of files
  without error to verify that you're booted in UEFI mode:
  
    # ls /sys/firmware/efi/efivars
    
    
1.7 Connect to the internet
  If you're wired then just plug in the ethernet and it should work fine.
  If using wifi, connect to the network with iwctl.
    
    # iwctl                   // this will give you an interactive prompt
    [iwd]# device list            // get the name of wireless device
    [iwd]# station *device* scan      // scan for wireless networks
    [iwd]# station *device* get-networks    // list networks
    [iwd]# station *device* connect *SSID*
    
  Enter the password when prompted and then exit with Ctrl+d.
  
  Verify the connection with:
  
    # ping archlinux.org
    
  
1.8 Update the system clock
  Just run the following command to make sure the clock is right
  
    # timedatectl status
    
1.9 Partition the disks
  List the disks with this command
    
    # lsblk -l
    
  You need one boot partition and one partition for the root directory.
  The boot partition should be 300M and the root directory should take
  up the rest of the available space on the disk.
  
  The boot partition should be type: EFI System Partition and the root
  directory partition should be type: Linux x86-64 root (/)
   
  Use cfdisk to make things easy:
  
    # cfdisk /dev/sdx
    

1.10 Format the partitions
  Format the root directory partition as ext4 with this command:
  
    # mkfs.ext4 /dev/*root_partition*
    
  And format the boot partition with this command:
  
    # mkfs.fat -F 32 /dev/*efi_partition*
    
    
1.11 Mount the file system
  Mount both partitions with these commands:
  
    # mount /dev/*root_partition* /mnt
    # mount --mkdir /dev/*efi_partition* /mnt/boot
    

/* 2. Installation */

2.1 Select the mirrors
  Sort mirrors with reflector:
  
    # reflector --latest 50 --sort rate --save /etc/pacman.d/mirrorlist
    

2.2 Install essential packages
  Use pacstrap to install initial packages:
    
    # pacstrap -K /mnt base linux linux-firmware base-devel networkmanager
                       gvim reflector man-db man-pages texinfo
                       
  
/* 3. Configure the system */

3.1 Fstab
  Run this command to generate an fstab file
  
    # genfstab -U /mnt >> /mnt/etc/fstab
    

3.2 Chroot
  Change root into the new install with this command:
  
    # arch-chroot /mnt
    

3.3 Time zone
  Set the time zone and generate /etc/adjtime with these commands:
  
    # ln -sf /usr/share/zoneinfo/Americas/New_York /etc/localtime
    # hwclock --systohc
    

3.4 Localization
  Edit /etc/local.gen and uncomment en_US.UTF-8 UTF-8. Then generate the
  locale.
  
    # vim /etc/locale.gen
    # locale-gen
  
  Create the locale.conf file and set the LANG variable:
  
    "/etc/locale.conf"   <- Name of the file, do not include in the file
    LANG=en_US.UTF-8
    
 
3.5 Network configuration
  Create the hostname file:
  
    "/etc/hostname"
    *hostname*
    
 
 3.6 Initramfs -skip
 
 3.7 Root password
  Set the root password:
    
    # passwd
    

3.8 Boot loader
  Setup the grub bootloader. Install the packages and then run the install
  script.
  
    # pacman -S grub efibootmgr
    # grub-install --target=x86_64-efi --efi-directory=/boot
                   --bootloader-id=GRUB
  
  Then generate the config:
  
    # grub-mkconfig -o /boot/grub/grub.cfg
    
  Install intel microcode and regenerate grub config file
  
    # pacman -S intel-ucode
    # grub-mkconfig -o /boot/grub/grub.cfg


/* 4. Reboot */

Exit the chroot by typing 'exit'. Unmount all partitions then shutdown.

  # umount -R /mnt
  # shutdown +0

Remove the installation medium and restart.

/* Post-install */
  This section sets up the newly installed system. Login to the new system
  as root.
  
  Setup a non-root user and set the password:
  
    $ useradd -m *user*
    $ passwd *user*
    
  Add the new user to the sudoers file with visudo
  
    $ EDITOR=vim visudo
    *user* ALL=(ALL:ALL) ALL
    
  Then logout of root and login as the new user. Create new user's home
  directory folders:
  
    $ pacman -S xdg-user-dirs
    $ xdg-user-dirs-update
    $ mkdir screenshots trash usb
    
  Setup pacman by editing pacman.conf to enable the multilib repo and
  enable parallel downloading:
  
    "/etc/pacman.conf"
    [options]
    ParallelDownloads = 5

    ...

    [multilib]
    Include = /etc/pacman.d/mirrorlist
  
  Set ParallelDownloads to 5 as shown and uncomment the multilib lines.

  Before installing anything run reflector again to sort the mirrors for
  the newly installed system
  
    $ sudo reflector --latest 50 --sort rate 
                     --save /etc/pacman.d/mirrorlist
  
  First download and setup git:
    $ sudo pacman -S git
    $ git config --global user.name "user_name"
    $ git config --global user.email "email"
    $ git config --global init.defaultBranch main
    $ git config --global color.ui auto
    $ git config --global pull.rebase false
    
  Install openssh for generating ssh keys for git:
    $ sudo pacman -S openssh
  
  Download X server:
    $ sudo pacman -S xorg-server
    
  Then install the proper set of GPU drivers:
    Intel:
      $ sudo pacman -S mesa lib32-mesa xf86-video-intel vulkan-intel
      
    Nvidia:
      $ sudo pacman -S nvidia nvidia-utils lib32-nvidia-utils
  
  Window manager and terminal:
    (replace this stuff with our own git repo later)
    Install dependencies first:
      $ sudo pacman -S libxft libxinerama rofi ttf-dejavu
      
    $ git clone git://git.suckless.org/dwm
    $ cd dwm
    $ make
    $ make clean install
    
    $ git clone git@github.com:markgallant01/st.git
    $ cd st
    $ make
    $ make clean install
    
  Window manager (anything more than xinit is bloat):
    $ pacman -S xorg-xinit
    $ cp /etc/X11/xinit/xinitrc ~/.xinitrc
    
    Then edit ~/.xinitrc so that it launches dwm at the very end with:
      'exec dwm'
    
    get xrandr settings from desktop
    
    stuff to add to dwm config.h:
      // add this import at the top so media keys work
      #include <X11/XF86keysym.h>
      
      // change modifier key from alt to super
      #define MODKEY Mod4Mask
      
      // custom functions for rofi, backlight, and media keys
      static const char *roficmd[] = { "rofi", "-show", "drun", NULL };
      static const char *upbright[] = { "xbacklight", "-inc", "5", NULL };
      static const char *downbright[] = { "xbacklight", "-dec", "5", NULL };
      static const char *upvol[] = { "pactl", "set-sink-volume", "@DEFAULT_SINK@", "+5%", NULL };
      static const char *downvol[] = { "pactl", "set-sink-volume", "@DEFAULT_SINK@", "-5%", NULL };
      static const char *mutevol[] = { "pactl", "set-sink-mute", "@DEFAULT_SINK@", "toggle", NULL };
      static const char *mutemic[] = { "pactl", "set-source-mute", "@DEFAULT_SOURCE@", "toggle", NULL };
      
      // custom key bindings for media keys
      { 0,	XF86XK_MonBrightnessUp,		spawn,		{.v = upbright } },
      { 0, 	XF86XK_MonBrightnessDown,	spawn,		{.v = downbright } },
      { 0,	XF86XK_AudioRaiseVolume,	spawn,		{.v = upvol } },
      { 0, 	XF86XK_AudioLowerVolume,	spawn,		{.v = downvol } },
      { 0,	XF86XK_AudioMute,		spawn,		{.v = mutevol } },
      { 0,	XF86XK_AudioMicMute,		spawn,		{.v = mutemic } },
      
    You should now be able to use the command 'startx' to launch into a
    graphical system.
    
  Power management:
    (come back to this)
    
  Sound system:
    $ pacman -S pipewire lib32-pipewire wireplumber pipewire-pulse blueman
    
  Clock synchronization:
    $ systemctl enable --now systemd-timesyncd.service
    
  Input devices:
    Create the file "/etc/X11/xorg.conf.d/00-input-devices.conf" and
    inside it put:
    
      Section "InputClass"
        Identifier "Pointing Device"
        MatchIsPointer "true"
        Driver "libinput"
        Option "AccelProfile" "flat"
      EndSection

      Section "InputClass"
        Identifier "Touchpad"
        MatchIsTouchpad "true"
        Driver "libinput"
        Option "AccelProfile" "flat"
        Option "Tapping" "true"
        Option "NaturalScrolling" "true"
      EndSection
    
    That should setup pointing devices to not have any acceleration and
    to use the proper touchpad settings.
  
  Performance:
    $ pacman -S htop
    
  USB stuff:
    $ pacman -S udisks2
  
  Printing:
    Maybe setup printing here in the future
    
  Setup Yay to use the AUR:
    $ git clone https://aur.archlinux.org/yay.git
    $ cd yay
    $ makepkg -si
    
  Downloading music from youtube:
    $ sudo pacman -S yt-dlp
    
  Web browsers:
    $ sudo pacman -S firefox chromium
    
  Discord:
    $ sudo pacman -S discord

  To-do:
    -neofetch
    -picom
    
    -continue customizing
     
    -move all these installation steps into one installer script that can
     be run after the OS has been installed and a non-root user has been
     created. The script will install all these programs and download all
     the relevant configs from our github.
