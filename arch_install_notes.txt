This is a compilation of notes to be used as supplementary material for
an arch linux install. Use alongside the installation guide found at
wiki.archlinux.org.

/***********************/
/* 1. Pre-installation */
/***********************/

1.1 Acqure an installation image
1.2 Verify signature
1.3 Prepare an installation medium
    -use a fresh arch iso
    -dd command is easiest:

        $ dd bs=4M if=path/to/archlinux.iso of=/dev/flashDrive \
            conv=fsync oflag=direct status=progress

1.4 Boot the live environment
1.5 Set the console keyboard layout and font
1.6 Verify the boot mode
1.7 Connect to the internet
    -If you're wired then just plug in the ethernet and it should work
    -If using wifi, connect to the network with iwctl.

    # iwctl                 // this will give you an interactive prompt
    [iwd]# device list               // get the name of wireless device
    [iwd]# station *device* scan          // scan for wireless networks
    [iwd]# station *device* get-networks               // list networks
    [iwd]# station *device* connect *SSID*        // connect to network

    -enter the password when prompted and then exit with Ctrl+d.
    -verify the connection with:

        # ping archlinux.org

1.8 Update the system clock
1.9 Partition the disks
    -format root drive as xfs.
    -boot drive needs 2 partitions: a 1G EFI boot partition
     and the rest of the drive is Linux x86_64 root xfs
    -list the drives with:

        # lsblk -l

    -and use cfdisk to make the partitioning easy.

    -for the swap file, on desktop suspend is unnecessary so 16G is
     more than enough. On a laptop use 1.5x RAM.

1.10 Format the partitions
1.11 Mount the file system

/*******************/
/* 2. Installation */
/*******************/

2.1 Select the mirrors
    -use vim to open the mirrorlist at /etc/pacman.d/mirrorlist and
     move the American mirror to the top of the list.

2.2 Install essential packages
    -in addition to the essential packages, install some more stuff that
     will be useful.

        # pacstrap -K /mnt base linux linux-firmware
            man-db man-pages texinfo
            vim networkmanager sudo
            reflector unzip
            xfsprogs                 <- depends on filesystem
            intel-ucode OR amd-ucode <- choose correct for CPU

/***************************/
/* 3. Configure the system */
/***************************/

3.1 Fstab
3.2 Chroot
3.3 Time zone
3.4 Localization
3.5 Network configuration
    -after setting up the hostname file, run this command to ensure
     NetworkManager starts up on reboot:

        # systemctl enable NetworkManager.service

3.6 Initramfs
3.7 Root password
3.8 Boot loader
    -Systemd-boot comes with systemD and is easy to use. It's already
     installed on the system. Initialize it:

        # bootctl install

    -Next, a loader configuration file must be created and set:
     (note 'efi' below corresponds to wherever the EFI directory was
     mounted. Probably /boot.)
    -These fields are separated by a space, not a tab.
     SystemD won't read tabs.

        "efi/loader/loader.conf"
        default arch.conf
        timeout 0
        console-mode keep

    -You'll need a corresponding arch.conf file in efi/loader/entries.
    -The UUID must be replaced with the UUID of the root partition.
     Copy it from the /etc/fstab file.
    -These can be tab-separated:

        "efi/loader/entries/arch.conf"
        title   Arch Linux
        linux   /vmlinuz-linux
        initrd  /initramfs-linux.img
        options root=UUID=xxxx-xxxxx-xxxx-xxxx-xxxx-xxxx  rw

    -use this command to make sure there's a new Arch Linux boot entry:

        # bootctl list

-finished with basic installation
-exit chroot, unmount drives and shutdown:

    # exit
    # umount -R /mnt
    # shutdown +0

-remove the installation USB and boot into the new system.

/****************/
/* Post-install */
/****************/

-this section sets up the newly installed system. Login to the
 new system as root.

-First, verify that the microcode is loaded properly. Use this
 command and read the output:

    # lsinitcpio --early /boot/initramfs-linux.img | head -n 5

-The last 2 lines should reference microcode for your CPU.

-setup a non-root user in the wheel groups and set the password:

    # useradd -m -G wheel <username>
    # passwd *user*

-add the new user to the sudoers file with visudo

    # EDITOR=vim visudo

    %wheel ALL=(ALL:ALL) ALL    // uncomment this line

-then logout of root and login as the new user.

-verify the internet:

    $ ping archlinux.org

-if on wifi, you may need to connect manually:

    $ nmcli device wifi list
    $ nmcli device wifi connect "SSID" password "password"

-setup pacman by editing pacman.conf to enable the multilib repo,
 color, and parallel downloads.
 (uncomment the lines):

    "/etc/pacman.conf"
    [options]
    ...
    Color
    ...
    VerbosePkgLists
    ParallelDownloads = 5
    ...
    [multilib]
    Include = /etc/pacman.d/mirrorlist

-run pacman once to generate and sync databases:

    $ sudo pacman -Syu

-run reflector once here for the fastest and most up to date mirrors

    $ sudo reflector --latest 20 --sort rate \
        --save /etc/pacman.d/mirrorlist

-download the setup and config files:

    $ curl -LJO https://github.com/markgallant01/.dotfiles\
        /archive/refs/heads/main.zip
    $ unzip .dotfiles-main.zip
    $ mv .dotfiles-main .dotfiles

-make the setup scripts executable:

    $ chmod +x ~/.dotfiles/scripts/setup.sh
    $ chmod +x ~/.dotfiles/scripts/install_packages.sh

-run the setup script:

    $ ~/.dotfiles/scripts/setup.sh

-launch the display server

    $ startx

-authenticate with github:
-launch web browser and login to github account.
-the installer script generated new ssh keys. print the public key:

    $ cat ~/.ssh/id_ed25519.pub

-copy this output and add it to github ssh keys
-verify the connection:

    $ ssh -T git@github.com

-once authenticated, fix dotfiles repo:

    $ rm -r ~/.dotfiles
    $ rm ~/.dotfiles-main.zip
    $ git clone git@github.com:markgallant01/.dotfiles.git

-install yay for the aur:

    $ mkdir ~/aur
    $ cd ~/aur
    $ git clone https://aur.archlinux.org/yay.git
    $ cd yay
    $ makepkg -si
    $ cd ~

-install any aur programs:

    $ yay -S deadbeef

-if nvidia drivers were installed, you must edit the file
 /etc/mkinitcpio.conf to remove the 'kms' module from the HOOKS array.
 This ensures the junk nouveau module will not be loaded during boot:

    $ sudo vim /etc/mkinitcpio.conf

    -after that, re-run the command to regenerate the initramfs

        $ sudo mkinitcpio -P

-now reboot and you should be finished:

    $ reboot

/*********************/
/* FINISHING TOUCHES */
/*********************/

-First, setup Firefox. Launch Firefox and log int so it syncs
 everything.
-Log in to Lastpass so we get all our passwords.
-Set the initial UI stuff that does not sync. Set the bookmark bar
 to 'always show'
-remove the unnecessary icons around the extentions and make sure
 Lastpass and Ublock are shown
-go into the settings and make sure everything looks right. Disable
 all search suggestions and set the default search engine to DuckDuckGo.
-Under 'Privacy & Security' disable 'Ask to save passwords', and all the
 'Autofill' options. Disable all history saving.
-make sure the noto fonts are set correctly. They should be setup
 automatically.
-go through the settings for each extensions and enable them for Private
 browser tabs
-Go into the special Lastpass settings and disable autofill.

-launch discord once to generate the config file.
-add the shown line in this file so Discord doesn't refuse to launch
 if there's an update that's not in the repo yet:

    ~/.config/discord/settings.json
    "SKIP_HOST_UPDATE": true

-Log into discord and set it up. Set the font size to 20. Set mic
 threshold.
-Disable 'minimize to tray' and automatic startup under Linux settings

-On desktop, use this command to set the volume to 100%:

    $ pactl set-sink-volume @DEFAULT_SINK@ 100%

-create additional directories in the home directory
 for any internal or external drives you want to mount:

    $ mkdir nvme_games ssd_storage

-set up the fstab here so that drives auto mount. Consult
 https://wiki.archlinux.org/title/Fstab for reference.

-place any wallpapers in ~/Photos/wallpaper/ for feh to use them

/***********/
/* THE END */
/***********/

To-do:
    -still need keybind to swap master and stack window super-"
    -get jellyfin up and running for media consumption
    -check out more wallpapers because the drawn ones seem better
    -add papirus-icon-theme to install list
    -currently using bibata-cursor-theme-bin from the aur. add this to
     the installation under the aur section if we stick with it
    -add ttf-nerd-fonts-symbols to installation list
    -make a nice landing page on web browser with common sites like
     arch wiki, reddit, youtube, etc. don't show bookmark bar by default
     because i rarely ever click it directly
    -add polybar to installation section and maybe conky too
    -wallpapers are getting double set again by awesome so figure that
     out
    -keep configuring topbar. make the tags group look good and
     function. get rid of the clock on the right side and replace it
     with a nice systray with good looking icons for volume, network,
     brightness, maybe buttons to restart and such
    -add alacritty to install list if its not already there. remove
     st section from install guide because its too stupid to patch
    -remove firefox from install section, add chromium for testing
     stuff.
    -fix nvim bufferline's background color to match lualine
    -sort out alacritty's font (nerdfont)
    -https://wiki.archlinux.org/title/GNOME/Keyring#PAM_step
     see if this fixes gnome-keyring asking for password sometimes,
     like when brave browser is launched. try to remember what else
     would cause the keyring to launch. if it's fixed, add a section
     to the installation guide.
    -try out the brave browser. add to aur section of installer
    -looks like thunar is handling auto-mounting so look into that
    -continue to configure alacritty. font size?
    -menubar transparency toggle, colorscheme toggle
    -thunar doesn't pop up when I insert a disk anymore since I
     installed baobab so figure that out
    -add baobab to utility section of install programs. its the gnome
     disk utility. maybe look and see if theres a better one but this
     one is fine too.
    -configure alacritty and clean up stuff
    -replace yay in the install script with yay-bin so we don't need
     to compile it. See if this is possible with other AUR packages.
    -switch from nvidia to nvidia-open
    -get a good nerd font patched with icons
    -add 'fd' to installed packages list. it's a utility
     thing for finding files that telescope.nvim needs
    -add language servers to package install file. So
     far just the lua one. Think of others. Clangd. pyright.
    -some kind of volume widget for pavucontrol that hangs out in the
     status bar would be cool
    -maim keeps the cursor in the image by default so it has to be run
     with the 'u' flag so the whole command looks like maim -us filename
     to do the selection snipping thing we typically like to do. maybe
     put this into a keybind or an alias so we don't have to remember
    -replace scrot with maim in the program installation section
    -add duckstation and pcsx2 to AUR section
    -stuff I want:
        -wallpaper spans entire screen including top bar. top bar should
         be transparent between the widgets because it looks cool
        -make menu stuff transparent like rofi and terminal with blur
         for a nice modern glass effect
        -neovim should not be transparent
        -if something isn't transparent it should have the same back
         ground as the desktop (like rofi)
        -window border should be thicker and color should match color
         scheme too
    -reduce keyboard repetition rate so that we can fly around nvim
     faster
    -wallpaper setting shouldn't be tracked so that we can have
     different settings on different PCs. move option out to a
     local setup file somehow
    -NVM is slowing down the terminal startup due to the initialization
     stuff it adds to the bachrc file. this is a pain in the ass
    -maybe add curl nvm installation idk yet
     Either AwesomeWM or Qtile. Stuff I want:
        -nice program launcher that lets me search for programs
         I've forgotten. Maybe Rofi?
        -login manager that looks nice. LightDM?
        -lock screen finally so we can walk away from PC without
         killing the x-server
    -add these files to stop the screen from shutting off:
     https://wiki.archlinux.org/title/Display_Power_Management_Signaling#Configuration
    -figure out why USB stuff seems to automount on laptop but not
     desktop
    -add libnatpmp to install list because its needed for
     the port_forwarding script to work. and add that script somewhere.
    -put protonvpn app in installation list and qbittorrent
    -maybe get suspend / hibernate to work
    -also laptop is starting on incorrect brightness but idk why
    -modify brightness step because we should be able to go darker than
     we currently can
    -get s-tui added to program install list and figure out the
     brightness for t450s.
    -get brighntess control working for desktop monitors
    -TLP for laptop battery saving. IDK if this will mess up desktop
     so come back to it
    -add tlp and the systemctl stuff to make it work. default settings.
    -add minecraft audio fix maybe
    -something weird going on with mounting the other drives on
     desktop. Maybe switch to UUIDs in case the labels are switching
    -get a cool nvim startup screen
    -change the wallpaper script to not switch to daytime wallpaper
     until 5am. 4 is too early.
    -continue to curate the wallpapers as we see them. They should
     scream their respective season.
    -modify the setup script to copy the screen setup script to the
     .config folder and add a step to set that up properly
    -might want to add a note about the intel i915 psr kernel parameter
     for that weird screen bug:
     https://wiki.archlinux.org/title/intel_graphics#Screen_flickering
    -incorporate the udev rule for the backlight:
     https://wiki.archlinux.org/title/Backlight#Hardware_interfaces
    -consider adding a section about configuring Xorg. Consult
     https://wiki.archlinux.org/title/NVIDIA#Xorg_configuration
    -setup a pacman hook to clean up the paccache after each install
    -I want a nice icon set for thunar
    -need a section to set up wallpapers or integrate it into the script
     somehow
    -use musicBrainz picard to tag all our music and sort it. then add
     picard to the install list
    -customize brave new tab page with custom css
    -add something about the symlink fix for fmod pipewire bug:
     https://wiki.archlinux.org/title/PipeWire#\
     FMOD_games_crashing_under_PipeWire
    -add section for android USB connection android-file-transfer
     package
    -maybe add SDL stuff to installer
    -setup a good screen locker that blocks tty access maybe
    -make keybind cheat sheet
    -add overthewire programs like telnet and nmap
    -look into this: https://wiki.archlinux.org/title/Gamemode#top-page
    -power management? (acpi?)

Bugs:
    -feh seems to span the wallpaper across both monitors if the timer
     triggers the script to run while the screens are off.
